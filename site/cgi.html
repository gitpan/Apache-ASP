

<html>
<head>
<title>Apache :: ASP :: CGI</title>



</head>
<body bgcolor=#bb4488 link=#003090 alink=#ff5599 vlink=#993399 
 marginheight=0 marginwidth=0 leftMargin=0 topMargin=0>





<table border=0 cellpadding=0 cellspacing=0 width=100%>
<tr bgcolor=#ff4488>
<td colspan=2>
	<table border=0 cellpadding=5 cellspacing=0 width=100%>
	<tr>
	<td><img border=0 src=apache_asp.gif alt="Apache :: ASP"></td>	
	
		<td align=right></td>
	
	</tr>
	</table>
</td>
</tr>
</table>

<table border=0 cellpadding=8 cellspacing=0 height=90% width=100%>
<tr>
<td valign=top width=100 bgcolor=#c0c0c0>
	<table border=0 cellpadding=0 cellspacing=0 width=100>

	
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=index.html style=text-decoration:none><font color=#003090>INTRO</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=install.html style=text-decoration:none><font color=#003090>INSTALL</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=config.html style=text-decoration:none><font color=#003090>CONFIG</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=syntax.html style=text-decoration:none><font color=#003090>SYNTAX</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=events.html style=text-decoration:none><font color=#003090>EVENTS</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=objects.html style=text-decoration:none><font color=#003090>OBJECTS</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=ssi.html style=text-decoration:none><font color=#003090>SSI</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=sessions.html style=text-decoration:none><font color=#003090>SESSIONS</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=xml.html style=text-decoration:none><font color=#003090>XML/XSLT</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>%</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><font color=#993399>CGI</font></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=perlscript.html style=text-decoration:none><font color=#003090>PERLSCRIPT</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=faq.html style=text-decoration:none><font color=#003090>FAQ</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=tuning.html style=text-decoration:none><font color=#003090>TUNING</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=kudos.html style=text-decoration:none><font color=#003090>CREDITS</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=support.html style=text-decoration:none><font color=#003090>SUPPORT</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=sites.html style=text-decoration:none><font color=#003090>SITES USING</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=resources.html style=text-decoration:none><font color=#003090>RESOURCES</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=todo.html style=text-decoration:none><font color=#003090>TODO</font></a></nobr></b></font></td>		

		</tr>
		
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=changes.html style=text-decoration:none><font color=#003090>CHANGES</font></a></nobr></b></font></td>		

		</tr>
		<tr><td colspan=2><hr size=1></td></tr>
		<tr>

		<td><font size=-2 face="verdana" color=#993399><b><nobr>&nbsp;</nobr></b></font></td>

		<td bgcolor=#c0c0c0><font face="verdana,arial" size=-1><b><nobr><a href=eg/index.html style=text-decoration:none><font color=#003090>EXAMPLES</font></a></nobr></b></font></td>		

		</tr>
		
	<tr>
		<td align=center colspan=2>
		<hr size=1>
		<center>
		<a href=http://www.nodeworks.com/asp/><img 
			src=powered_by_apache_asp.jpg border=0
			alt="Powered by Apache::ASP"
			></a>
		<br>
		<a href=http://perl.apache.org><img 
			src=powered_by_modperl.gif border=0
			alt="Powered by ModPerl and Apache"
			></a>
		<br>
		<a href=http://www.nodeworks.com/partner.htm?partner_id=apacheasp><img 
			src=nodecheck_button.gif border=0
			alt="Links Checked by NodeWorks"
			></a>
		</center>
		<hr size=1>
		</td>
	</tr>
	</table>
</td>



<td valign=top bgcolor=white>
<font size=-1 face=verdana>

<font face=verdana><font size=+1 color=#555555><b>CGI</b></font><p>
<font face="lucida console,courier new" size=3><pre>
</pre></font><a href=cgi.html><font size=-1 face=verdana><b>CGI</b></font></a> has been the standard way of deploying web applications long before
ASP came along.  <a href=http://stein.cshl.org/WWW/software/CGI/cgi_docs.html><font size=-1 face=verdana><b>CGI.pm</b></font></a> is a very useful module that aids developers in 
the building of these applications, and Apache::ASP has been made to 
be compatible with function calls in CGI.pm.  Please see cgi.htm in the 
./site/eg directory for a sample ASP script written almost entirely in CGI.
<font face="lucida console,courier new" size=3><pre>
</pre></font>As of version 0.09, use of CGI.pm for both input and output is seamless
when working under Apache::ASP.  Thus if you would like to port existing
cgi scripts over to Apache::ASP, all you need to do is wrap <% %> around
the script to get going.  This functionality has been implemented so that
developers may have the best of both worlds when building their 
web applications.
<font face="lucida console,courier new" size=3><pre>
</pre></font>Following are some special notes with respect to compatibility with CGI.
Use of CGI.pm in any of these ways was made possible through a great
amount of work, and is not guaranteed to be portable with other perl ASP
implementations, as other ASP implementations will likely be more limited.</font>

	<hr size=1>
	<table width=100% border=0 cellpadding=1 cellspacing=3>
	<tr>
	<td valign=top><font face="lucida console" size=-1>
	<ul>
	
		<tr>
		
			<td valign=top >
			<font face="lucida console" size=-1>
			<a href=#Query%20Object%20Initialization><font color=#003090>Query Object Initialization</font></a>
			</font>
			</td>
		
			<td valign=top >
			<font face="lucida console" size=-1>
			<a href=#print%28%29ing%20CGI><font color=#003090>print()ing CGI</font></a>
			</font>
			</td>
							
		</tr>
		
		<tr>
		
			<td valign=top >
			<font face="lucida console" size=-1>
			<a href=#CGI%20headers><font color=#003090>CGI headers</font></a>
			</font>
			</td>
		
			<td valign=top >
			<font face="lucida console" size=-1>
			<a href=#File%20Upload><font color=#003090>File Upload</font></a>
			</font>
			</td>
							
		</tr>
			
	</table>
	<hr size=1>
	<p>

	<p>
	<a name=Query%20Object%20Initialization></a>
	<font face=verdana><font size=+0 color=#555555><b>Query Object Initialization</b></font><p>
<font face="lucida console,courier new" size=3><pre>
</pre></font>You may create a <a href=cgi.html><font size=-1 face=verdana><b>CGI</b></font></a>.pm $query object like so:
<font face="lucida console,courier new" size=3><pre>
	use CGI;
	my $query = new CGI;
</pre></font>As of Apache::ASP version 0.09, form input may be read in 
by <a href=http://stein.cshl.org/WWW/software/CGI/cgi_docs.html><font size=-1 face=verdana><b>CGI.pm</b></font></a> upon initialization.  Before, Apache::ASP would 
consume the form input when reading into $Request->Form(), 
but now form input is cached, and may be used by CGI.pm input
routines.</font>
	
	<p>
	<a name=CGI%20headers></a>
	<font face=verdana><font size=+0 color=#555555><b>CGI headers</b></font><p>
<font face="lucida console,courier new" size=3><pre>
</pre></font>Not only can you use the <a href=cgi.html><font size=-1 face=verdana><b>CGI</b></font></a>.pm $query->header() method
to put out headers, but with the CgiHeaders config option
set to true, you can also print "Header: value\n", and add 
similar lines to the top of your script, like:
<font face="lucida console,courier new" size=3><pre>
 Some-Header: Value
 Some-Other: OtherValue

 &lt;html&gt;&lt;body&gt; Script body starts here.
</pre></font>Once there are no longer any cgi style headers, or the 
there is a newline, the body of the script begins. So
if you just had an asp script like:
<font face="lucida console,courier new" size=3><pre>
    print join(&quot;:&quot;, %{$Request-&gt;QueryString});
</pre></font>You would likely end up with no output, as that line is
interpreted as a header because of the semicolon.  When doing
basic debugging, as long as you start the page with <html>
you will avoid this problem.</font>
	
	<p>
	<a name=print%28%29ing%20CGI></a>
	<font face=verdana><font size=+0 color=#555555><b>print()ing CGI</b></font><p>
<font face="lucida console,courier new" size=3><pre>
</pre></font><a href=cgi.html><font size=-1 face=verdana><b>CGI</b></font></a> is notorious for its print() statements, and the functions in <a href=http://stein.cshl.org/WWW/software/CGI/cgi_docs.html><font size=-1 face=verdana><b>CGI.pm</b></font></a> 
usually return strings to print().  You can do this under Apache::ASP,
since print just aliases to $Response->Write().  Note that $| has no
affect.
<font face="lucida console,courier new" size=3><pre>
	print $query-&gt;header();
	print $query-&gt;start_form(); </pre></font>
	
	<p>
	<a name=File%20Upload></a>
	<font face=verdana><font size=+0 color=#555555><b>File Upload</b></font><p>
<font face="lucida console,courier new" size=3><pre>
</pre></font><a href=cgi.html><font size=-1 face=verdana><b>CGI</b></font></a>.pm is used for implementing reading the input from file upload.  You
may create the file upload form however you wish, and then the 
data may be recovered from the file upload by using $Request->Form().
Data from a file upload gets written to a file handle, that may in
turn be read from.  The original file name that was uploaded is the 
name of the file handle.
<font face="lucida console,courier new" size=3><pre>
	my $filehandle = $Request-&gt;Form('file_upload_field_name');
	print $filehandle; # will get you the file name
	my $data;
	while(read($filehandle, $data, 1024)) {
		# data from the uploaded file read into $data
	};
</pre></font>Please see the docs on <a href=http://stein.cshl.org/WWW/software/CGI/cgi_docs.html><font size=-1 face=verdana><b>CGI.pm</b></font></a> (try perldoc CGI) for more information
on this topic, and <a href=eg/file_upload.asp>./site/eg/file_upload.asp</a> for an example of its use.
<font face="lucida console,courier new" size=3><pre>
</pre></font>There is a $Request->FileUpload() API extension that you can use to get 
more data about a file upload, so that the following properties are
available for querying:
<font face="lucida console,courier new" size=3><pre>
  my $file_upload = $Request-&gt;{FileUpload}{upload_field};
  $file_upload-&gt;{BrowserFile}
  $file_upload-&gt;{FileHandle}
  $file_upload-&gt;{ContentType}

  # only if FileUploadTemp is set
  $file_upload-&gt;{TempFile}

  # whatever mime headers are sent with the file upload
  # just &quot;keys %$file_upload&quot; to find out
  $file_upload-&gt;{?Mime-Header?}
</pre></font>Please see the $Request section in <a href=objects.html><font size=-1 face=verdana><b>OBJECTS</b></font></a> for more information.</font>
	

</font>
</td>
</tr>
<tr bgcolor=#555555>
	<td colspan=2 align=center width=80%>
	<font face=verdana color=white size=-1>
	Copyright &copy; 1998-2000, Joshua Chamas, 
	<a href=http://www.chamas.com><font color=white>Chamas Enterprises Inc.</font></a>
	</font>
	</td>
</tr>
</table>
</body>
</html>
