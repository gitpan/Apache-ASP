

<html>
<head>
<title>Apache :: ASP :: OBJECTS [ Active Server Pages for Apache with mod_perl ]</title>



</head>
<body bgcolor=white link=#3355cc alink=#ff5599 vlink=#993399>

<table border=0 cellpadding=5 cellspacing=0 height=95% width=100%>
<tr><td colspan=2 bgcolor=#ff4488><img src=apache_asp.gif alt="Apache :: ASP"></td></tr>
<tr>

<td valign=top bgcolor=#ffcccc>
	<table border=0 cellpadding=0 cellspacing=0>
	<tr><td align=center><hr size=1></td></tr>

	
		<tr>
		<td><a href=index.html><font face=verdana size=-1 color=#3355cc>INTRO</font></a></td>
		</tr>
		
		<tr>
		<td><a href=install.html><font face=verdana size=-1 color=#3355cc>INSTALL</font></a></td>
		</tr>
		
		<tr>
		<td><a href=config.html><font face=verdana size=-1 color=#3355cc>CONFIG</font></a></td>
		</tr>
		
		<tr>
		<td><a href=syntax.html><font face=verdana size=-1 color=#3355cc>SYNTAX</font></a></td>
		</tr>
		
		<tr>
		<td><a href=events.html><font face=verdana size=-1 color=#3355cc>EVENTS</font></a></td>
		</tr>
		
		<tr>
		<td><a href=objects.html><font face=verdana size=-1 color=#3355cc>OBJECTS</font></a></td>
		</tr>
		
		<tr>
		<td><a href=ssi.html><font face=verdana size=-1 color=#3355cc>SSI</font></a></td>
		</tr>
		
		<tr>
		<td><a href=cgi.html><font face=verdana size=-1 color=#3355cc>CGI</font></a></td>
		</tr>
		
		<tr>
		<td><a href=perlscript.html><font face=verdana size=-1 color=#3355cc>PERLSCRIPT</font></a></td>
		</tr>
		
		<tr>
		<td><a href=faq.html><font face=verdana size=-1 color=#3355cc>FAQ</font></a></td>
		</tr>
		
		<tr>
		<td><a href=tuning.html><font face=verdana size=-1 color=#3355cc>TUNING</font></a></td>
		</tr>
		
		<tr>
		<td><a href=kudos.html><font face=verdana size=-1 color=#3355cc>CREDITS</font></a></td>
		</tr>
		
		<tr>
		<td><a href=support.html><font face=verdana size=-1 color=#3355cc>SUPPORT</font></a></td>
		</tr>
		
		<tr>
		<td><a href=sites.html><font face=verdana size=-1 color=#3355cc>SITES USING</font></a></td>
		</tr>
		<tr><td><hr size=1></td></tr>
		<tr>
		<td><a href=eg/index.html><font face=verdana size=-1 color=#3355cc>EXAMPLES</font></a></td>
		</tr>
		
	<tr>
		<td align=center>
		<hr size=1>
		<a href=http://perl.apache.org><img 
			src=modperl.gif border=0
			alt="Powered by ModPerl & Apache"
			></a>
		<hr size=1>
		</td>
	</tr>
	</table>
</td>

<td valign=top>
<font face=verdana><font size=+1 color=#555555><b>OBJECTS</b></font><p>
The beauty of the ASP Object Model is that it takes the
burden of <a href=cgi.html>CGI</a> and Session Management off the developer, 
and puts them in objects accessible from any
ASP script &amp; include.  For the perl programmer, treat these objects
as globals accesible from anywhere in your ASP application.
<font face="courier new"><pre>
  Currently the Apache::ASP object model supports the following:

    Object	 -	Function
    ------		--------
    $Session	 -	session state
    $Response	 -	output
    $Request	 -	input
    $Application -	application state
    $Server	 -	OLE support + misc
</pre></font>These objects, and their methods are further defined in the 
following sections.</font>

	<hr size=1>
	<table width=100% border=0 cellpadding=5><tr><td valign=top><font face=verdana size=-1>
	<a href=#%24Session%20Object><font color=#3355cc>$Session Object</font></a><br><br><a href=#%24Session-%3E%7BCodePage%7D><font color=#3355cc>$Session->{CodePage}</font></a><br><a href=#%24Session-%3E%7BLCID%7D><font color=#3355cc>$Session->{LCID}</font></a><br><a href=#%24Session-%3E%7BSessionID%7D><font color=#3355cc>$Session->{SessionID}</font></a><br><a href=#%24Session-%3E%7BTimeout%7D%20%5B%3D%20%24minutes%5D><font color=#3355cc>$Session->{Timeout} [= $minutes]</font></a><br><a href=#%24Session-%3EAbandon%28%29><font color=#3355cc>$Session->Abandon()</font></a><br><a href=#%24Session-%3ELock%28%29%20%20><font color=#3355cc>$Session->Lock()  </font></a><br><a href=#%24Session-%3EUnLock%28%29><font color=#3355cc>$Session->UnLock()</font></a><br><br><a href=#%24Response%20Object><font color=#3355cc>$Response Object</font></a><br><br><a href=#%24Response-%3E%7BBuffer%7D><font color=#3355cc>$Response->{Buffer}</font></a><br><a href=#%24Response-%3E%7BCacheControl%7D><font color=#3355cc>$Response->{CacheControl}</font></a><br><a href=#%24Response-%3E%7BCharset%7D><font color=#3355cc>$Response->{Charset}</font></a><br><a href=#%24Response-%3E%7BClean%7D%20%3D%200-9%3B><font color=#3355cc>$Response->{Clean} = 0-9;</font></a><br><a href=#%24Response-%3E%7BContentType%7D%20%3D%20%22text%2Fhtml%22><font color=#3355cc>$Response->{ContentType} = "text/html"</font></a><br><a href=#%24Response-%3E%7BExpires%7D%20%3D%20%24time><font color=#3355cc>$Response->{Expires} = $time</font></a><br><a href=#%24Response-%3E%7BExpiresAbsolute%7D%20%3D%20%24date><font color=#3355cc>$Response->{ExpiresAbsolute} = $date</font></a><br><a href=#%24Response-%3E%7BIsClientConnected%7D><font color=#3355cc>$Response->{IsClientConnected}</font></a><br><a href=#%24Response-%3E%7BPICS%7D><font color=#3355cc>$Response->{PICS}</font></a><br><a href=#%24Response-%3E%7BStatus%7D%20%3D%20%24status><font color=#3355cc>$Response->{Status} = $status</font></a><br><a href=#%24Response-%3EAddHeader%28%24name%2C%20%24value%29><font color=#3355cc>$Response->AddHeader($name, $value)</font></a><br><a href=#%24Response-%3EAppendToLog%28%24message%29><font color=#3355cc>$Response->AppendToLog($message)</font></a><br><a href=#%24Response-%3EBinaryWrite%28%24data%29><font color=#3355cc>$Response->BinaryWrite($data)</font></a><br><a href=#%24Response-%3EClear%28%29><font color=#3355cc>$Response->Clear()</font></a><br><a href=#%24Response-%3ECookies%28%24name%2C%20%5B%24key%2C%5D%20%24value%29><font color=#3355cc>$Response->Cookies($name, [$key,] $value)</font></a><br><a href=#%24Response-%3EDebug%28%40args%29><font color=#3355cc>$Response->Debug(@args)</font></a><br><a href=#%24Response-%3EEnd%28%29><font color=#3355cc>$Response->End()</font></a><br></font></td><td valign=top><font face=verdana size=-1><a href=#%24Response-%3EFlush%28%29><font color=#3355cc>$Response->Flush()</font></a><br><a href=#%24Response-%3EInclude%28%24filename%2C%20%40args%29><font color=#3355cc>$Response->Include($filename, @args)</font></a><br><a href=#%24Response-%3ERedirect%28%24url%29><font color=#3355cc>$Response->Redirect($url)</font></a><br><a href=#%24Response-%3EWrite%28%24data%29><font color=#3355cc>$Response->Write($data)</font></a><br><br><a href=#%24Request%20Object><font color=#3355cc>$Request Object</font></a><br><br><a href=#%24Request-%3E%7BTotalBytes%7D><font color=#3355cc>$Request->{TotalBytes}</font></a><br><a href=#%24Request-%3EBinaryRead%28%24length%29><font color=#3355cc>$Request->BinaryRead($length)</font></a><br><a href=#%24Request-%3EClientCertificate%28%29><font color=#3355cc>$Request->ClientCertificate()</font></a><br><a href=#%24Request-%3ECookies%28%24name%20%5B%2C%24key%5D%29><font color=#3355cc>$Request->Cookies($name [,$key])</font></a><br><a href=#%24Request-%3EForm%28%24name%29><font color=#3355cc>$Request->Form($name)</font></a><br><a href=#%24Request-%3EQueryString%28%24name%29><font color=#3355cc>$Request->QueryString($name)</font></a><br><a href=#%24Request-%3EServerVariables%28%24name%29><font color=#3355cc>$Request->ServerVariables($name)</font></a><br><br><a href=#%24Application%20Object><font color=#3355cc>$Application Object</font></a><br><br><a href=#%24Application-%3ELock%28%29><font color=#3355cc>$Application->Lock()</font></a><br><a href=#%24Application-%3EUnLock%28%29><font color=#3355cc>$Application->UnLock()</font></a><br><a href=#%24Application-%3ESessionCount%28%29><font color=#3355cc>$Application->SessionCount()</font></a><br><br><a href=#%24Server%20Object><font color=#3355cc>$Server Object</font></a><br><br><a href=#%24Server-%3E%7BScriptTimeout%7D%20%3D%20%24seconds><font color=#3355cc>$Server->{ScriptTimeout} = $seconds</font></a><br><a href=#%24Server-%3ECreateObject%28%24program_id%29><font color=#3355cc>$Server->CreateObject($program_id)</font></a><br><a href=#%24Server-%3EHTMLEncode%28%24string%29><font color=#3355cc>$Server->HTMLEncode($string)</font></a><br><a href=#%24Server-%3EMapPath%28%24url%29%3B><font color=#3355cc>$Server->MapPath($url);</font></a><br><a href=#%24Server-%3EURLEncode%28%24string%29><font color=#3355cc>$Server->URLEncode($string)</font></a><br><a href=#%24Server-%3ERegisterCleanup%28%24sub_reference%29%20><font color=#3355cc>$Server->RegisterCleanup($sub_reference) </font></a><br>	
	</font>
	</td>
	</tr>
	</table>
	<hr size=1>
	<p>

	<p>
	<a name=%24Session%20Object></a>
	<font face=verdana><font size=+0 color=#555555><b>$Session Object</b></font><p>
The $Session object keeps track of user + web client state, in
a persistent manner, making it relatively easy to develop web 
applications.  The $Session state is stored accross HTTP connections,
in database files in the Global directory, and will persist across
server restarts.
<font face="courier new"><pre>
</pre></font>The user session is referenced by a 128 bit / 32 byte MD5 hex hashed cookie, 
and can be considered secure from session_id guessing, or session hijacking.
When a hacker fails to guess a session, the system times out for a
second, and with 2**128 (3.4e38) keys to guess, a hacker will not be 
guessing an id any time soon.  
<font face="courier new"><pre>
</pre></font>If an incoming cookie matches a timed out or non-existent session,
a new session is created with the incoming id.  If the id matches a
currently active session, the session is tied to it and returned.
This is also similar to the Microsoft ASP implementation.
<font face="courier new"><pre>
</pre></font>The $Session refererence is a hash ref, and can be used as such to 
store data as in: 
<font face="courier new"><pre>
    $Session-&gt;{count}++;	# increment count by one
    %{$Session} = ();	# clear $Session data
</pre></font>The $Session object state is implemented through MLDBM,
and a user should be aware of the limitations of MLDBM.  
Basically, you can read complex structures, but not write 
them, directly:
<font face="courier new"><pre>
  $data = $Session-&gt;{complex}{data};     # Read ok.
  $Session-&gt;{complex}{data} = $data;     # Write NOT ok.
  $Session-&gt;{complex} = {data =&gt; $data}; # Write ok, all at once.
</pre></font>Please see MLDBM for more information on this topic.
$Session can also be used for the following methods and properties:</font>
	
	<p>
	<a name=%24Session-%3E%7BCodePage%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->{CodePage}</b></font><p>
Not implemented.  May never be until someone explains what its
supposed to do.</font>
	
	<p>
	<a name=%24Session-%3E%7BLCID%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->{LCID}</b></font><p>
Not implemented.  May never be until someone explains what its
supposed to do.</font>
	
	<p>
	<a name=%24Session-%3E%7BSessionID%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->{SessionID}</b></font><p>
SessionID property, returns the id for the current session,
which is exchanged between the client and the server as a cookie.</font>
	
	<p>
	<a name=%24Session-%3E%7BTimeout%7D%20%5B%3D%20%24minutes%5D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->{Timeout} [= $minutes]</b></font><p>
Timeout property, if minutes is being assigned, sets this 
default timeout for the user session, else returns 
the current session timeout.  
<font face="courier new"><pre>
</pre></font>If a user session is inactive for the full
timeout, the session is destroyed by the system.
No one can access the session after it times out, and the system
garbage collects it eventually.</font>
	
	<p>
	<a name=%24Session-%3EAbandon%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->Abandon()</b></font><p>
The abandon method times out the session immediately.  All Session
data is cleared in the process, just as when any session times out.</font>
	
	<p>
	<a name=%24Session-%3ELock%28%29%20%20></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->Lock()  </b></font><p>
API extension. If you are about to use $Session for many consecutive 
reads or writes, you can improve performance by explicitly locking 
$Session, and then unlocking, like:
<font face="courier new"><pre>
  $Session-&gt;Lock();
  $Session-&gt;{count}++;
  $Session-&gt;{count}++;
  $Session-&gt;{count}++;
  $Session-&gt;UnLock();
</pre></font>This sequence causes $Session to be locked and unlocked only
1 time, instead of the 6 times that it would be locked otherwise,
2 for each increment with one to read and one to write.
<font face="courier new"><pre>
</pre></font>Because of flushing issues with SDBM_File and DB_File databases,
each lock actually ties fresh to the database, so the performance
savings here can be considerable.  
<font face="courier new"><pre>
</pre></font>Note that if you have SessionSerialize set, $Session is
already locked for each script invocation automatically, as if
you had called $Session-&gt;Lock() in Script_OnStart.  Thus you 
do not need to worry about $Session locking for performance.
Please read the section on SessionSerialize for more info.</font>
	
	<p>
	<a name=%24Session-%3EUnLock%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Session->UnLock()</b></font><p>
API Extension. Unlocks the $Session explicitly.  If you do not call this,
$Session will be unlocked automatically at the end of the 
script.</font>
	
	<p>
	<a name=%24Response%20Object></a>
	<font face=verdana><font size=+0 color=#555555><b>$Response Object</b></font><p>
This object manages the output from the ASP Application and the 
client web browser.  It does not store state information like the 
$Session object but does have a wide array of methods to call.</font>
	
	<p>
	<a name=%24Response-%3E%7BBuffer%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{Buffer}</b></font><p>
Default 1, when TRUE sends output from script to client only at
the end of processing the script.  When 0, response is not buffered,
and client is sent output as output is generated by the script.</font>
	
	<p>
	<a name=%24Response-%3E%7BCacheControl%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{CacheControl}</b></font><p>
Default &quot;private&quot;, when set to public allows proxy servers to 
cache the content.  This setting controls the value set
in the HTTP header Cache-Control</font>
	
	<p>
	<a name=%24Response-%3E%7BCharset%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{Charset}</b></font><p>
This member when set appends itself to the value of the Content-Length
HTTP header.  If $Response-&gt;{Charset} = 'ISO-LATIN-1' is set, the 
corresponding header would look like:
<font face="courier new"><pre>
  Content-Type:text/html; charset=ISO-LATIN-1</pre></font>
	
	<p>
	<a name=%24Response-%3E%7BClean%7D%20%3D%200-9%3B></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{Clean} = 0-9;</b></font><p>
API extension. Set the Clean level, default 0, on a per script basis.  
Clean of 1-9 compresses text/html output.  Please see
the Clean config option for more information.</font>
	
	<p>
	<a name=%24Response-%3E%7BContentType%7D%20%3D%20%22text%2Fhtml%22></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{ContentType} = "text/html"</b></font><p>
Sets the MIME type for the current response being sent to the client.
Sent as an HTTP header.</font>
	
	<p>
	<a name=%24Response-%3E%7BExpires%7D%20%3D%20%24time></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{Expires} = $time</b></font><p>
Sends a response header to the client indicating the $time 
in SECONDS in which the document should expire.  A time of 0 means
immediate expiration.  The header generated is a standard
HTTP date like: &quot;Wed, 09 Feb 1994 22:23:32 GMT&quot;.</font>
	
	<p>
	<a name=%24Response-%3E%7BExpiresAbsolute%7D%20%3D%20%24date></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{ExpiresAbsolute} = $date</b></font><p>
Sends a response header to the client with $date being an absolute
time to expire.  Formats accepted are all those accepted by 
HTTP::Date::str2time(), e.g.
<font face="courier new"><pre>
 &quot;Wed, 09 Feb 1994 22:23:32 GMT&quot;       -- HTTP format
 &quot;Tuesday, 08-Feb-94 14:15:29 GMT&quot;     -- old rfc850 HTTP format

 &quot;08-Feb-94&quot;         -- old rfc850 HTTP format    (no weekday, no time)
 &quot;09 Feb 1994&quot;       -- proposed new HTTP format  (no weekday, no time)

 &quot;Feb  3  1994&quot;      -- Unix 'ls -l' format
 &quot;Feb  3 17:03&quot;      -- Unix 'ls -l' format</pre></font>
	
	<p>
	<a name=%24Response-%3E%7BIsClientConnected%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{IsClientConnected}</b></font><p>
Not implemented, but returns 1 currently for portability.  This is 
value is not yet relevant, and may not be until apache 1.3.6, which will 
be tested shortly.  Apache versions less than 1.3.6 abort the perl code 
immediately upon the client dropping the connection.</font>
	
	<p>
	<a name=%24Response-%3E%7BPICS%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{PICS}</b></font><p>
If this property has been set, a PICS-Label HTTP header will be
sent with its value.  For those that do not know, PICS is a header
that is useful in rating the internet.  It stands for 
Platform for Internet Content Selection, and you can find more
info about it at: <a href=http://www.w3.org>http://www.w3.org</a></font>
	
	<p>
	<a name=%24Response-%3E%7BStatus%7D%20%3D%20%24status></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->{Status} = $status</b></font><p>
Sets the status code returned by the server.  Can be used to
set messages like 500, internal server error</font>
	
	<p>
	<a name=%24Response-%3EAddHeader%28%24name%2C%20%24value%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->AddHeader($name, $value)</b></font><p>
Adds a custom header to a web page.  Headers are sent only before any
text from the main page is sent, so if you want to set a header
after some text on a page, you must turn BufferingOn.</font>
	
	<p>
	<a name=%24Response-%3EAppendToLog%28%24message%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->AppendToLog($message)</b></font><p>
Adds $message to the server log.  Useful for debugging.</font>
	
	<p>
	<a name=%24Response-%3EBinaryWrite%28%24data%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->BinaryWrite($data)</b></font><p>
Writes binary data to the client.  The only
difference from $Response-&gt;Write() is that $Response-&gt;Flush()
is called internally first, so the data cannot be parsed 
as an html header.  Flushing flushes the header if has not
already been written.
<font face="courier new"><pre>
</pre></font>If you have set the $Reponse-&gt;{ContentType}
to something other than text/html, cgi header parsing (see <a href=cgi.html>CGI</a>
notes), will be automatically be turned off, so you will not
necessarily need to use BinaryWrite for writing binary data.
<font face="courier new"><pre>
</pre></font>For an example of BinaryWrite, see the gif.htm example 
in ./site/eg/gif.htm
<font face="courier new"><pre>
</pre></font>Please note that if you are on Win32, you will need to 
call binmode on a file handle before reading, if 
its data is binary.</font>
	
	<p>
	<a name=%24Response-%3EClear%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Clear()</b></font><p>
Erases buffered ASP output.</font>
	
	<p>
	<a name=%24Response-%3ECookies%28%24name%2C%20%5B%24key%2C%5D%20%24value%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Cookies($name, [$key,] $value)</b></font><p>
Sets the key or attribute of cookie with name $name to the value $value.
If $key is not defined, the Value of the cookie is set.
ASP CookiePath is assumed to be / in these examples.
<font face="courier new"><pre>
 $Response-&gt;Cookies('name', 'value');
  --&gt; Set-Cookie: name=value; path=/

 $Response-&gt;Cookies(&quot;Test&quot;, &quot;data1&quot;, &quot;test value&quot;);
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;data2&quot;, &quot;more test&quot;);
 $Response-&gt;Cookies(
	&quot;Test&quot;, &quot;Expires&quot;,
	&amp;HTTP::Date::time2str(time+86400)
	);
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Secure&quot;, 1);
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Path&quot;, &quot;/&quot;);
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Domain&quot;, &quot;host.com&quot;);
  --&gt;	Set-Cookie:Test=data1=test%20value&amp;data2=more%20test;	\
 		expires=Fri, 23 Apr 1999 07:19:52 GMT;		\
 		path=/; domain=host.com; secure
</pre></font>The latter use of $key in the cookies not only sets cookie attributes
such as Expires, but also treats the cookie as a hash of key value pairs
which can later be accesses by
<font face="courier new"><pre>
 $Request-&gt;Cookies('Test', 'data1');
 $Request-&gt;Cookies('Test', 'data2');
</pre></font>Because this is perl, you can (NOT PORTABLE) reference the cookies
directly through hash notation.  The same 5 commands above could be compressed to:
<font face="courier new"><pre>
 $Response-&gt;{Cookies}{Test} =
	{
		Secure	=&gt; 1,
		Value	=&gt;
			{
				data1 =&gt; 'test value',
				data2 =&gt; 'more test'
			},
		Expires	=&gt; 86400, # not portable shortcut, see above
		Domain	=&gt; 'host.com',
		Path    =&gt; '/'
	};
</pre></font>and the first command would be:
<font face="courier new"><pre>
 # you don't need to use hash notation when you are only setting
 # a simple value
 $Response-&gt;{Cookies}{'Test Name'} = 'Test Value';
</pre></font>I prefer the hash notation for cookies, as this looks nice, and is 
quite perlish.  It is here to stay.  The Cookie() routine is 
very complex and does its best to allow access to the 
underlying hash structure of the data.  This is the best emulation 
I could write trying to match the Collections functionality of 
cookies in <a href=http://www.microsoft.com/iis/>IIS</a> ASP.
<font face="courier new"><pre>
</pre></font>For more information on Cookies, please go to the source at
<a href=http://home.netscape.com/newsref/std/cookie_spec.html>http://home.netscape.com/newsref/std/cookie_spec.html</a></font>
	
	<p>
	<a name=%24Response-%3EDebug%28%40args%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Debug(@args)</b></font><p>
API Extension. If the Debug config option is set greater than 0, 
this routine will write @args out to server error log.  refs in @args 
will be expanded one level deep, so data in simple data structures
like one-level hash refs and array refs will be displayed.  CODE
refs like
<font face="courier new"><pre>
 $Response-&gt;Debug(sub { &quot;some value&quot; });
</pre></font>will be executed and their output added to the debug output.
This extension allows the user to tie directly into the
debugging capabilities of this module.
<font face="courier new"><pre>
</pre></font>While developing an app on a production server, it is often 
useful to have a separate error log for the application
to catch debuging output separately.  One way of implementing 
this is to use the Apache ErrorLog configuration directive to 
create a separate error log for a virtual host. 
<font face="courier new"><pre>
</pre></font>If you want further debugging support, like stack traces
in your code, consider doing things like:
<font face="courier new"><pre>
 $Response-&gt;Debug( sub { Carp::longmess('debug trace') };
 $SIG{__WARN__} = \&amp;Carp::cluck; # then warn() will stack trace
</pre></font>The only way at present to see exactly where in your script
an error occured is to set the Debug config directive to 2,
and match the error line number to perl script generated
from your ASP script.  
<font face="courier new"><pre>
</pre></font>However, as of version 0.10, the perl script generated from the 
asp script should match almost exactly line by line, except in 
cases of inlined includes, which add to the text of the original script, 
pod comments which are entirely yanked out, and &lt;% # comment %&gt; style
comments which have a \n added to them so they still work.
<font face="courier new"><pre>
</pre></font>If you would like to see the HTML preceeding an error 
while developing, consider setting the BufferingOn 
config directive to 0.</font>
	
	<p>
	<a name=%24Response-%3EEnd%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->End()</b></font><p>
Sends result to client, and immediately exits script.
Automatically called at end of script, if not already called.</font>
	
	<p>
	<a name=%24Response-%3EFlush%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Flush()</b></font><p>
Sends buffered output to client and clears buffer.</font>
	
	<p>
	<a name=%24Response-%3EInclude%28%24filename%2C%20%40args%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Include($filename, @args)</b></font><p>
This API extension calls the routine compiled from asp script
in $filename with the args @args.  This is a direct translation
of the <a href=ssi.html>SSI</a> tag 
<font face="courier new"><pre>
  &lt;!--#include file=$filename args=@args--&gt;
</pre></font>Please see the <a href=ssi.html>SSI</a> section for more on <a href=ssi.html>SSI</a> in general.
<font face="courier new"><pre>
</pre></font>This API extension was created to allow greater modularization
of code by allowing includes to be called with runtime 
arguments.  Files included are compiled once, and the 
anonymous coderef from that compilation is cached, thus
including a file in this manner is just like calling a 
perl subroutine.</font>
	
	<p>
	<a name=%24Response-%3ERedirect%28%24url%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Redirect($url)</b></font><p>
Sends the client a command to go to a different url $url.  
Script immediately ends.</font>
	
	<p>
	<a name=%24Response-%3EWrite%28%24data%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Response->Write($data)</b></font><p>
Write output to the HTML page.  &lt;%=$data%&gt; syntax is shorthand for
a $Response-&gt;Write($data).  All final output to the client must at
some point go through this method.</font>
	
	<p>
	<a name=%24Request%20Object></a>
	<font face=verdana><font size=+0 color=#555555><b>$Request Object</b></font><p>
The request object manages the input from the client brower, like
posts, query strings, cookies, etc.  Normal return results are values
if an index is specified, or a collection / perl hash ref if no index 
is specified.  WARNING, the latter property is not supported in 
Activeware PerlScript, so if you use the hashes returned by such
a technique, it will not be portable.
<font face="courier new"><pre>
 # A normal use of this feature would be to iterate through the
 # form variables in the form hash...

 $form = $Request-&gt;Form();
 for(keys %{$form}) {
	$Response-&gt;Write(&quot;$_: $form-&gt;{$_}&lt;br&gt;\n&quot;);
 }

 # Please see the ./site/eg/server_variables.htm asp file for this
 # method in action.</pre></font>
	
	<p>
	<a name=%24Request-%3E%7BTotalBytes%7D></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->{TotalBytes}</b></font><p>
The amount of data sent by the client in the body of the 
request, usually the length of the form data.  This is
the same value as $Request-&gt;ServerVariables('CONTENT_LENGTH')</font>
	
	<p>
	<a name=%24Request-%3EBinaryRead%28%24length%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->BinaryRead($length)</b></font><p>
Returns a scalar whose contents are the first $length bytes
of the form data, or body, sent by the client request.
This data is the raw data sent by the client, without any
parsing done on it by Apache::ASP.</font>
	
	<p>
	<a name=%24Request-%3EClientCertificate%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->ClientCertificate()</b></font><p>
Not implemented.</font>
	
	<p>
	<a name=%24Request-%3ECookies%28%24name%20%5B%2C%24key%5D%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->Cookies($name [,$key])</b></font><p>
Returns the value of the Cookie with name $name.  If a $key is
specified, then a lookup will be done on the cookie as if it were
a query string.  So, a cookie set by:
<font face="courier new"><pre>
 Set-Cookie: test=data1=1&amp;data2=2
</pre></font>would have a value of 2 returned by $Request-&gt;Cookies('test','data2').
<font face="courier new"><pre>
</pre></font>If no name is specified, a hash will be returned of cookie names 
as keys and cookie values as values.  If the cookie value is a query string, 
it will automatically be parsed, and the value will be a hash reference to 
these values.
<font face="courier new"><pre>
</pre></font>When in doubt, try it out.  Remember that unless you set the Expires
attribute of a cookie with $Response-&gt;Cookies('cookie', 'Expires', $xyz),
the cookies that you set will only last until you close your browser, 
so you may find your self opening &amp; closing your browser a lot when 
debugging cookies.
<font face="courier new"><pre>
</pre></font>For more information on cookies in ASP, please read $Response-&gt;Cookies()</font>
	
	<p>
	<a name=%24Request-%3EForm%28%24name%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->Form($name)</b></font><p>
Returns the value of the input of name $name used in a form
with POST method.  If $name is not specified, returns a ref to 
a hash of all the form data.  
<font face="courier new"><pre>
</pre></font>File upload data will be loaded into $Request-&gt;Form('file_field'), 
where the value is the actual file name of the file uploaded, and 
the contents of the file can be found by reading from the file
name as a file handle as in:
<font face="courier new"><pre>
 while(read($Request-&gt;Form('file_field_name'), $data, 1024)) {};
</pre></font>For more information, please see the <a href=cgi.html>CGI</a> / File Upload section,
as file uploads are implemented via the <a href=http://stein.cshl.org/WWW/software/CGI/cgi_docs.html>CGI.pm</a> module.  An
example can be found in the installation 
samples ./site/eg/file_upload.asp</font>
	
	<p>
	<a name=%24Request-%3EQueryString%28%24name%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->QueryString($name)</b></font><p>
Returns the value of the input of name $name used in a form
with GET method, or passed by appending a query string to the end of
a url as in http://localhost/?data=value.  
If $name is not specified, returns a ref to a hash of all the query 
string data.</font>
	
	<p>
	<a name=%24Request-%3EServerVariables%28%24name%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Request->ServerVariables($name)</b></font><p>
Returns the value of the server variable / environment variable
with name $name.  If $name is not specified, returns a ref to 
a hash of all the server / environment variables data.  The following
would be a common use of this method:
<font face="courier new"><pre>
 $env = $Request-&gt;ServerVariables();
 # %{$env} here would be equivalent to the cgi %ENV in perl.</pre></font>
	
	<p>
	<a name=%24Application%20Object></a>
	<font face=verdana><font size=+0 color=#555555><b>$Application Object</b></font><p>
Like the $Session object, you may use the $Application object to 
store data across the entire life of the application.  Every
page in the ASP application always has access to this object.
So if you wanted to keep track of how many visitors there where
to the application during its lifetime, you might have a line
like this:
<font face="courier new"><pre>
 $Application-&gt;{num_users}++
</pre></font>The Lock and Unlock methods are used to prevent simultaneous 
access to the $Application object.</font>
	
	<p>
	<a name=%24Application-%3ELock%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Application->Lock()</b></font><p>
Locks the Application object for the life of the script, or until
UnLock() unlocks it, whichever comes first.  When $Application
is locked, this gaurantees that data being read and written to it 
will not suddenly change on you between the reads and the writes.
<font face="courier new"><pre>
</pre></font>This and the $Session object both lock automatically upon
every read and every write to ensure data integrity.  This 
lock is useful for concurrent access control purposes.
<font face="courier new"><pre>
</pre></font>Be careful to not be too liberal with this, as you can quickly 
create application bottlenecks with its improper use.</font>
	
	<p>
	<a name=%24Application-%3EUnLock%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Application->UnLock()</b></font><p>
Unlocks the $Application object.  If already unlocked, does nothing.</font>
	
	<p>
	<a name=%24Application-%3ESessionCount%28%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Application->SessionCount()</b></font><p>
This NON-PORTABLE method returns the current number of active sessions,
in the application.  This method is not implemented as part of the ASP
object model, but is implemented here because it is useful.  In particular,
when accessing databases with license requirements, one can monitor usage
effectively through accessing this value.
<font face="courier new"><pre>
</pre></font>This is a new feature as of v.06, and if run on a site with previous 
versions of Apache::ASP, the count may take a while to synch up.  To ensure
a correct count, you must delete all the current state files associated
with an application, usually in the $Global/.state directory.</font>
	
	<p>
	<a name=%24Server%20Object></a>
	<font face=verdana><font size=+0 color=#555555><b>$Server Object</b></font><p>
The server object is that object that handles everything the other
objects do not.  The best part of the server object for Win32 users is 
the CreateObject method which allows developers to create instances of
ActiveX components, like the ADO component.</font>
	
	<p>
	<a name=%24Server-%3E%7BScriptTimeout%7D%20%3D%20%24seconds></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->{ScriptTimeout} = $seconds</b></font><p>
Not implemented. May never be.  Please see the 
Apache Timeout configuration option, normally in httpd.conf.</font>
	
	<p>
	<a name=%24Server-%3ECreateObject%28%24program_id%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->CreateObject($program_id)</b></font><p>
Allows use of ActiveX objects on Win32.  This routine returns
a reference to an Win32::OLE object upon success, and nothing upon
failure.  It is through this mechanism that a developer can 
utilize ADO.  The equivalent syntax in VBScript is 
<font face="courier new"><pre>
 Set object = Server.CreateObject(program_id)
</pre></font>For further information, try 'perldoc Win32::OLE' from your
favorite command line.</font>
	
	<p>
	<a name=%24Server-%3EHTMLEncode%28%24string%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->HTMLEncode($string)</b></font><p>
Returns an HTML escapes version of $string. &amp;, &quot;, &gt;, &lt;, are each
escapes with their HTML equivalents.  Strings encoded in this nature
should be raw text displayed to an end user, as HTML tags become 
escaped with this method.                                 &quot;</font>
	
	<p>
	<a name=%24Server-%3EMapPath%28%24url%29%3B></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->MapPath($url);</b></font><p>
Given the url $url, absolute, or relative to the current executing script,
this method returns the equivalent filename that the server would 
translate the request to, regardless or whether the request would be valid.
<font face="courier new"><pre>
</pre></font>Only a $url that is relative to the host is valid.  Urls like &quot;.&quot; and 
&quot;/&quot; are fine arguments to MapPath, but &quot;http://localhost&quot; would not be.
<font face="courier new"><pre>
</pre></font>To see this method call in action, check out the sample ./site/eg/server.htm
script.</font>
	
	<p>
	<a name=%24Server-%3EURLEncode%28%24string%29></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->URLEncode($string)</b></font><p>
Returns the URL-escaped version of the string $string. +'s are substituted in
for spaces and special characters are escaped to the ascii equivalents.
Strings encoded in this manner are safe to put in url's... they are especially
useful for encoding data used in a query string as in:
<font face="courier new"><pre>
 $data = $Server-&gt;URLEncode(&quot;test data&quot;);
 $url = &quot;http://localhost?data=$data&quot;;

 $url evaluates to http://localhost?data=test+data, and is a
 valid URL for use in anchor &lt;a&gt; tags and redirects, etc.</pre></font>
	
	<p>
	<a name=%24Server-%3ERegisterCleanup%28%24sub_reference%29%20></a>
	<font face=verdana><font size=-1 color=#555555><b>$Server->RegisterCleanup($sub_reference) </b></font><p>
<font face="courier new"><pre> non-portable extension
</pre></font>Sets a subroutine reference to be executed after the script ends,
whether normally or abnormally, the latter occuring 
possibly by the user hitting the STOP button, or the web server
being killed.  This subroutine must be a code reference 
created like:
<font face="courier new"><pre>
 $Server-&gt;RegisterCleanup(sub { $main::Session-&gt;{served}++; });
   or
 sub served { $main::Session-&gt;{served}++; }
 $Server-&gt;RegisterCleanup(\&amp;served);
</pre></font>The reference to the subroutine passed in will be executed.
Though the subroutine will be executed in anonymous context, 
instead of the script, all objects will still be defined 
in main::*, that you would reference normally in your script.  
Output written to $main::Response will have no affect at 
this stage, as the request to the www client has already completed.
<font face="courier new"><pre>
</pre></font>Check out the ./site/eg/register_cleanup.asp script for an example
of this routine in action.</font>
	

</td>
</tr>
<tr bgcolor=#555555>
	<td colspan=2 align=center width=80%>
	<font face=verdana color=white size=-1>Copyright (c) 1998-1999, Joshua Chamas, Chamas Enterprises Inc. </font>
	</td>
</tr>
</table>
</body>
</html>