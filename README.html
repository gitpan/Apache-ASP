    <HTML> 
	<HEAD> 
	    <TITLE>Apache::ASP - Active Server Pages for Apache (all platforms)

</TITLE> 
	</HEAD>

	<BODY>

<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#NAME">NAME</A>
	<LI><A HREF="#SYNOPSIS">SYNOPSIS</A>
	<LI><A HREF="#DESCRIPTION">DESCRIPTION</A>
	<UL>

		<LI><A HREF="#INSTALLATION">INSTALLATION</A>
		<LI><A HREF="#CONFIG">CONFIG</A>
	</UL>

	<LI><A HREF="#ASP_Syntax">ASP Syntax</A>
	<LI><A HREF="#The_Object_Model">The Object Model</A>
	<UL>

		<LI><A HREF="#_Session_Object">$Session Object</A>
		<LI><A HREF="#_Response_Object">$Response Object</A>
		<LI><A HREF="#_Request_Object">$Request Object</A>
		<LI><A HREF="#_Application_Object">$Application Object</A>
		<LI><A HREF="#_Server_Object">$Server Object</A>
	</UL>

	<LI><A HREF="#EXAMPLES">EXAMPLES</A>
	<LI><A HREF="#FAQ">FAQ</A>
	<LI><A HREF="#SEE_ALSO">SEE ALSO</A>
	<LI><A HREF="#NOTES">NOTES</A>
	<LI><A HREF="#SUPPORT">SUPPORT</A>
	<LI><A HREF="#COPYRIGHT">COPYRIGHT</A>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="NAME">NAME

</A></H1>
<PRE> Apache::ASP - Active Server Pages for Apache (all platforms)
</PRE>

<P>

<P>
<HR>
<H1><A NAME="SYNOPSIS">SYNOPSIS

</A></H1>
<PRE> SetHandler perl-script
 PerlHandler Apache::ASP
 PerlSetVar Global /tmp # must be some writeable directory
</PRE>

<P>

<P>
<HR>
<H1><A NAME="DESCRIPTION">DESCRIPTION

</A></H1>
This module provides a Active Server Pages port to Apache. Active Server
Pages is a web application platform that originated with Microsoft's IIS
server. Under Apache for both Win32 and Unix, it allows a developer to
create web applications with session management and perl embedded in static
html files.


<P>

This is a portable solution, similar to ActiveWare's PerlScript and MKS's
PScript implementation of perl for IIS ASP. Theoretically, one should be
able to take a solution that runs under Apache::ASP and run it without
change under PerlScript or PScript for IIS.


<P>

<P>
<HR>
<H2><A NAME="INSTALLATION">INSTALLATION

</A></H2>
Apache::ASP installs easily using the make or nmake commands as shown
below. Otherwise, just copy ASP.pm to $PERLLIB/site/Apache


<P>

<PRE> &gt; perl Makefile.PL
 &gt; make 
 &gt; make test
 &gt; make install
</PRE>

<P>

<PRE> * use nmake for win32
</PRE>

<P>

<P>
<HR>
<H2><A NAME="CONFIG">CONFIG

</A></H2>
Use with Apache. Copy the /eg directory from the ASP installation to your
Apache document tree and try it out! You have to put


<P>

<PRE> AllowOverride All
</PRE>

<P>

in your &lt;Directory&gt; config section to let the .htaccess file in the
/eg installation directory do its work.


<P>

If you want a STARTER config file, just look at the .htaccess file in the
/eg directory.


<P>

Here is a Location directive that you would put in a *.conf Apache
configuration file. It describes the ASP variables that you can set. Don't
set the optional ones if you don't want, the defaults are fine...


<P>

<PRE> ##ASP##PERL##APACHE##UNIX##WINNT##ASP##PERL##APACHE##NOT##IIS##ASP##
 ## INSERT INTO Apache *.conf file, probably access.conf
 ##ASP##PERL##APACHE##ACTIVE##SERVER##PAGES##SCRIPTING##FREE##PEACE##
</PRE>

<P>

<PRE> &lt;Location /asp/&gt;    
</PRE>

<P>

<PRE> ###########################################################
 ## mandatory 
 ###########################################################
</PRE>

<P>

<PRE> # Generic apache directives to make asp start ticking.
 SetHandler perl-script
 PerlHandler Apache::ASP
</PRE>

<P>

<PRE> # Global
 # ------
 # Must be some writeable directory.  Session and Application
 # state files will be stored in this directory, and 
 # as this directory is pushed onto @INC, you will be 
 # able to &quot;use&quot; and &quot;require&quot; files in this directory.
 #
 PerlSetVar Global /tmp  
        
 ###########################################################
 ## optional flags 
 ###########################################################
</PRE>

<P>

<PRE> # CookiePath
 # ----------
 # Url root that client responds to by sending the session cookie.
 # If your asp application falls under the server url &quot;/ASP&quot;, 
 # then you would set this variable to /ASP.  This then allows
 # you to run different applications on the same server, with
 # different user sessions for each application.
 #
 PerlSetVar CookiePath /   
</PRE>

<P>

<PRE> # AllowSessionState
 # -----------------
 # Set to 0 for no session tracking, 1 by default
 # If Session tracking is turned off, performance improves,
 # but the $Session object is inaccessible.
 #
 PerlSetVar AllowSessionState 1    
</PRE>

<P>

<PRE> # SessionTimeout
 # --------------
 # Session timeout in minutes (defaults to 20)
 #
 PerlSetVar SessionTimeout 20 
</PRE>

<P>

<PRE> # Debug
 # -----
 # 1 for server log debugging, 2 for extra client html output
 # Use 1 for production debugging, use 2 for development.
 # Turn off if you are not debugging.
 #
 PerlSetVar Debug 2     
</PRE>

<P>

<PRE> # BufferingOn
 # -----------
 # default 1, if true, buffers output through the response object.
 # $Response object will only send results to client browser if
 # a $Response-&gt;Flush() is called, or if the asp script ends.  Lots of 
 # output will need to be flushed incrementally.
 # 
 # If false, 0, the output is immediately written to the client,
 # CGI style.
 #
 # I would only turn this off if you have a really robust site,
 # since error handling is poor, if your asp script errors
 # after sending only some text.
 #
 PerlSetVar BufferingOn 1
</PRE>

<P>

<PRE> # StatINC
 # -------
 # default 0, if true, reloads perl libraries that have changed
 # on disk automatically for ASP scripts.  If false, the www server
 # must be restarted for library changes to take effect.
 #
 # A known bug is that any functions that are exported, e.g. confess 
 # Carp qw(confess), will not be refreshed by StatINC.  To refresh
 # these, you must restart the www server.  
 #
 PerlSetVar StatINC 1
</PRE>

<P>

<PRE> # SessionSerialize
 # ----------------
 # default 0, if true, locks $Session for duration of script, which
 # serializes requests to the $Session object.  Only one script at
 # a time may run, with sessions allowed.
 # 
 # Serialized requests to the session object is the Microsoft ASP way, 
 # but is dangerous in a production environment, where there is risk
 # of long-running or run-away processes.  If these things happen,
 # a session may be locked for an indefinate period of time.  The
 # terrible STOP button, would be easy prey here, where a user
 # keeps hitting stop and reload, and the scripts execute one at a time
 # until finished.  A run-away process would keep the session locked
 # until server restart.
 #
 PerlSetVar SessionSerialize 0
</PRE>

<P>

<PRE> # SoftRedirect
 # ------------
 # default 0, if true, a $Response-&gt;Redirect() does not end the 
 # script.  Normally, when a Redirect() is called, the script
 # is ended automatically.  SoftRedirect 1, is a standard
 # way of doing redirects, allowing for html output after the 
 # redirect is specified.
 #
 SoftRedirect 0
</PRE>

<P>

<PRE> &lt;/Location&gt;
</PRE>

<P>

<PRE> ##ASP##PERL##APACHE##UNIX##WINNT##ASP##PERL##APACHE##NOT##IIS##ASP##
 ## END INSERT
 ##ASP##PERL##APACHE##ACTIVE##SERVER##PAGES##SCRIPTING##!#MICROSOFT##
</PRE>

<P>

You can use the same config in .htaccess files without the Location tag. I
use the &lt;Files ~ (\.asp)&gt; tag in the .htaccess file of the directory
that I want to run my asp application. This allows me to mix other file
types in my application, static or otherwise.


<P>

<P>
<HR>
<H1><A NAME="ASP_Syntax">ASP Syntax

</A></H1>
ASP embedding syntax allows one to embed code in html in 2 simple ways. The
first is the &lt;% xxx %&gt; tag in which xxx is any valid perl code. The
second is &lt;%= xxx %&gt; where xxx is some scalar value that will be
inserted into the html directly. An easy print.


<P>

<PRE> A simple asp page would look like:
</PRE>

<P>

<PRE> &lt;!-- sample here --&gt;
 &lt;html&gt;
 &lt;body&gt;
 For loop incrementing font size: &lt;p&gt;
 &lt;% for(1..5) { %&gt;
        &lt;!-- iterated html text --&gt;
        &lt;font size=&quot;&lt;%=$_%&gt;&quot; &gt; Size = &lt;%=$_%&gt; &lt;/font&gt; &lt;br&gt;
 &lt;% } %&gt;
 &lt;/body&gt;
 &lt;/html&gt;
 &lt;!-- end sample here --&gt;
</PRE>

<P>

Notice that your perl code blocks can span any html. The for loop above
iterates over the html without any special syntax.


<P>

<P>
<HR>
<H1><A NAME="The_Object_Model">The Object Model

</A></H1>
The beauty of the ASP Object Model is that it takes the burden of CGI and
Session Management off the developer, and puts them in objects accessible
from any ASP page. For the perl programmer, treat these objects as globals
accesible from anywhere in your ASP application.


<P>

<PRE> Currently the Apache::ASP object model supports the following:
</PRE>

<P>

<PRE> Object         --      Function
 ------                 --------
 $Session       --      session state
 $Response      --      output
 $Request       --      input
 $Application   --      application state
 $Server        --      OLE support + misc
</PRE>

<P>

These objects, and their methods are further defined in the following
sections.


<P>

<P>
<HR>
<H2><A NAME="_Session_Object">$Session Object

</A></H2>
The <CODE>$Session</CODE> object keeps track of user + web client state, in
a persistent manner, making it relatively easy to develop web applications.
The <CODE>$Session</CODE> state is stored accross HTTP connections, in
SDBM_Files in the Global directory, and will persist across server
restarts.


<P>

The user's session is referenced by a 32-byte md5-hashed cookie, and can be
considered secure from session_id guessing, or session hijacking. When a
hacker fails to guess a session, the system times out for a second, and
with 2**128 (3.4e38) keys to guess, a hacker won't be guessing an id any
time soon. Compare the 32-byte key with Miscrosoft ASP implementation which
is only 16 bytes.


<P>

If an incoming cookie matches a timed out or non-existent session, a new
session is created with the incoming id. If the id matches a currently
active session, the session is tied to it and returned. This is also
similar to Microsoft's ASP implementation.


<P>

The <CODE>$Session</CODE> ref is a hash ref, and can be used as such to
store data as in: 


<P>

<PRE> $Session-&gt;{count}++;   # increment count by one
 %{$Session} = ();      # clear $Session data
</PRE>

<P>

The <CODE>$Session</CODE> object state is implemented through MLDBM &amp;
SDBM_File, and a user should be aware of MLDBM's limitations. Basically,
you can read complex structures, but not write them, directly:


<P>

<PRE> $data = $Session-&gt;{complex}{data};      # Read ok.
 $Session-&gt;{complex}{data} = $data;      # Write NOT ok.
 $Session-&gt;{complex} = {data =&gt; $data};  # Write ok, all at once.
</PRE>

<P>

Please see MLDBM for more information on this topic. <CODE>$Session</CODE>
can also be used for the following methods and properties:


<P>

<DL>
<DT><STRONG><A NAME="item__Session_SessionID_">$Session->SessionID()

</A></STRONG><DD>
SessionID property, returns the id number for the current session, which is
exchanged between the client and the server as a cookie.


<P>

<DT><STRONG><A NAME="item__Session_Timeout_minutes_">$Session->Timeout($minutes)

</A></STRONG><DD>
Timeout property, if minutes is defined, sets this session's default
timeout, else returns the current session timeout. If a user session is
inactive for the full timeout, the user's session is destroyed by the
system. No one can access the session after it times out, and the system
garbage collects it eventually.


<P>

<DT><STRONG><A NAME="item__Session_Abandon_">$Session->Abandon()

</A></STRONG><DD>
The abandon method times out the session immediately. All Session data is
cleared in the process, just as when any session times out.


<P>

</DL>
<P>
<HR>
<H2><A NAME="_Response_Object">$Response Object

</A></H2>
This object manages the output from the ASP Application and the client's
web browser. It does store state information like the <CODE>$Session</CODE>
object but does have a wide array of methods to call.


<P>

<DL>
<DT><STRONG><A NAME="item__Response_Buffer_">$Response->{Buffer}

</A></STRONG><DD>
Default 1, when TRUE sends output from script to client only at the end of
processing the script. When 0, response is not buffered, and client is sent
output as output is generated by the script.


<P>

<DT><STRONG><A NAME="item__Response_ContentType_">$Response->{ContentType} = "text/html"

</A></STRONG><DD>
Sets the MIME type for the current response being sent to the client. Sent
as an HTTP header.


<P>

<DT><STRONG><A NAME="item__Response_Expires_">$Response->{Expires} = $time

</A></STRONG><DD>
Sends a response header to the client indicating the <CODE>$time</CODE> in
SECONDS in which the document should expire. A time of 0 means immediate
expiration. The header generated is a standard HTTP date like: ``Wed, 09
Feb 1994 22:23:32 GMT''.


<P>

<DT><STRONG><A NAME="item__Response_ExpiresAbsolute_">$Response->{ExpiresAbsolute} = $date

</A></STRONG><DD>
Sends a response header to the client with <CODE>$date</CODE> being an
absolute time to expire. Formats accepted are all those accepted by
HTTP::Date::str2time(), e.g.


<P>

<PRE> &quot;Wed, 09 Feb 1994 22:23:32 GMT&quot;       -- HTTP format
 &quot;Tuesday, 08-Feb-94 14:15:29 GMT&quot;     -- old rfc850 HTTP format
</PRE>

<P>

<PRE> &quot;08-Feb-94&quot;         -- old rfc850 HTTP format    (no weekday, no time)
 &quot;09 Feb 1994&quot;       -- proposed new HTTP format  (no weekday, no time)
</PRE>

<P>

<PRE> &quot;Feb  3  1994&quot;      -- Unix 'ls -l' format
 &quot;Feb  3 17:03&quot;      -- Unix 'ls -l' format
</PRE>

<P>

<DT><STRONG><A NAME="item__Response_AddHeader_name_">$Response->AddHeader($name, $value)

</A></STRONG><DD>
Adds a custom header to a web page. Headers are sent only before any text
from the main page is sent, so if you want to set a header after some text
on a page, you must turn BufferingOn.


<P>

<DT><STRONG><A NAME="item__Response_AppendToLog_message_">$Response->AppendToLog($message)

</A></STRONG><DD>
Adds <CODE>$message</CODE> to the server log.


<P>

<DT><STRONG><A NAME="item__Response_BinaryWrite_data_">$Response->BinaryWrite($data)

</A></STRONG><DD>
Writes binary data to a page for use by client objects. Could someone
explain this to me? This currently does nothing more than a
<CODE>Write($data),</CODE> since binary data can be in a scalar.


<P>

<DT><STRONG><A NAME="item__Response_Clear_">$Response->Clear()

</A></STRONG><DD>
Erases buffered ASP output.


<P>

<DT><STRONG><A NAME="item__Response_Cookies_name_key_v">$Response->Cookies($name,$key,$value) (alpha)

</A></STRONG><DD>
Sets the key or attribute of cookie with name <CODE>$name</CODE> to the
value $value. If <CODE>$key</CODE> is not defined, then the Value of the
cookie is assumed. ASP CookiePath is assumed to be / in these examples.


<P>

<PRE> $Response-&gt;Cookies(&quot;Test Name&quot;, &quot;&quot;, &quot;Test Value&quot;); 
   [... results in ...]
 Set-Cookie: Test+Name=Test+Value path=/            
</PRE>

<P>

<PRE> $Response-&gt;Cookies(&quot;Test&quot;, &quot;data1&quot;, &quot;test value&quot;);     
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;data2&quot;, &quot;more test&quot;);      
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Expires&quot;, &amp;<A HREF="HTTP::Date::time2str">HTTP::Date::time2str</A>(time() + 86400))); 
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Secure&quot;, 1);               
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Path&quot;, &quot;/&quot;);
 $Response-&gt;Cookies(&quot;Test&quot;, &quot;Domain&quot;, &quot;host.com&quot;);
   [... results in ...]
 Set-Cookie: Test=data1=test+value&amp;data2=more+test; expires=Wed, 09 Feb 1994 22:23:32 GMT; path=/; domain=host.com; secure 
</PRE>

<P>

Because this is perl, you can (NOT PORTABLE) reference the cookies directly
through hash notation. The same 5 commands above could be compressed to:


<P>

<PRE> $Response-&gt;{Cookies}{Test} = { 
        Secure  =&gt; 1, 
        Value   =&gt; {data1 =&gt; 'test value', data2 =&gt; 'more test'},
        Expires =&gt; 86400, # not portable shortcut, see above for proper use
        Domain  =&gt; 'host.com',
        Path    =&gt; '/'
        };
</PRE>

<P>

and the first command would be:


<P>

<PRE> # you don't need to use hash notation when you are only setting 
 # a simple value
 $Response-&gt;{Cookies}{'Test Name'} = 'Test Value'; 
</PRE>

<P>

For more information on Cookies, please go to the source at: <A
HREF="http://home.netscape.com/newsref/std/cookie_spec.html">http://home.netscape.com/newsref/std/cookie_spec.html</A>



<P>

<DT><STRONG><A NAME="item__Response_End_">$Response->End()

</A></STRONG><DD>
Sends result to client, and immediately exits script. Automatically called
at end of script, if not already called.


<P>

<DT><STRONG><A NAME="item__Response_Flush_">$Response->Flush()

</A></STRONG><DD>
Sends buffered output to client and clears buffer.


<P>

<DT><STRONG><A NAME="item__Response_Redirect_url_">$Response->Redirect($url)

</A></STRONG><DD>
Sends the client a command to go to a different url $url. Script
immediately ends.


<P>

<DT><STRONG><A NAME="item__Response_Status_">$Response->{Status} = $status

</A></STRONG><DD>
Sets the status code returned by the server. Can be used to set messages
like 500, internal server error


<P>

<DT><STRONG><A NAME="item__Response_Write_data_">$Response->Write($data)

</A></STRONG><DD>
Write output to the HTML page. &lt;%=$data%&gt; syntax is shorthand for a
$Response-&gt;Write($data). All final output to the client must at some
point go through this method.


<P>

</DL>
<P>
<HR>
<H2><A NAME="_Request_Object">$Request Object

</A></H2>
The request object manages the input from the client brower, like posts,
query strings, cookies, etc. Normal return results are values if an index
is specified, or a collection / perl hash ref if no index is specified.
WARNING, the latter property is not supported in Activeware's PerlScript,
so if you use the hashes returned by such a technique, it will not be
portable.


<P>

<PRE> # A normal use of this feature would be to iterate through the 
 # form variables in the form hash...
</PRE>

<P>

<PRE> $form = $Request-&gt;Form();
 for(keys %{$form}) {
        $Response-&gt;Write(&quot;$_: $form-&gt;{$_}&lt;br&gt;\n&quot;);
 }
</PRE>

<P>

<PRE> # Please see the eg/server_variables.htm asp file for this 
 # method in action.
</PRE>

<P>

<DL>
<DT><STRONG><A NAME="item__Request_ClientCertificate_">$Request->ClientCertificate()

</A></STRONG><DD>
Not implemented.


<P>

<DT><STRONG><A NAME="item__Request_Cookies_name_">$Request->Cookies($name, $key) (alpha)

</A></STRONG><DD>
Returns the value of the Cookie with name $name. If a <CODE>$key</CODE> is
specified, then a lookup will be done on the cookie as if it were a query
string. So, a cookie set by:


<P>

<PRE> Set-Cookie: test=data1=1&amp;data2=2
</PRE>

<P>

would have a value of 2 returned by $Request-&gt;Cookies('test', 'data2').


<P>

If no name is specified, a hash will be returned of cookie names as keys
and cookie values as values. If the cookie value is a query string, it will
automatically be parsed, and the value will be a hash reference to these
values.


<P>

<DT><STRONG><A NAME="item__Request_Form_name_">$Request->Form($name)

</A></STRONG><DD>
Returns the value of the input of name <CODE>$name</CODE> used in a form
with POST method. If <CODE>$name</CODE> is not specified, returns a ref to
a hash of all the form data.


<P>

<DT><STRONG><A NAME="item__Request_QueryString_name_">$Request->QueryString($name)

</A></STRONG><DD>
Returns the value of the input of name <CODE>$name</CODE> used in a form
with GET method, or passed by appending a query string to the end of a url
as in <A
HREF="http://someurl.com/?data=value.">http://someurl.com/?data=value.</A>
If <CODE>$name</CODE> is not specified, returns a ref to a hash of all the
query string data.


<P>

<DT><STRONG><A NAME="item__Request_ServerVariables_name_">$Request->ServerVariables($name)

</A></STRONG><DD>
Returns the value of the server variable / environment variable with name
$name. If <CODE>$name</CODE> is not specified, returns a ref to a hash of
all the server / environment variables data. The following would be a
common use of this method:


<P>

<PRE> $env = $Request-&gt;ServerVariables();
 # %{$env} here would be equivalent to the cgi %ENV in perl.
</PRE>

<P>

</DL>
<P>
<HR>
<H2><A NAME="_Application_Object">$Application Object

</A></H2>
Like the <CODE>$Session</CODE> object, you may use the
<CODE>$Application</CODE> object to store data across the entire life of
the application. Every page in the ASP application always has access to
this object. So if you wanted to keep track of how many visitors there
where to the application during its lifetime, you might have a line like
this:


<P>

<PRE> $Application-&gt;{num_users}++
</PRE>

<P>

The Lock and Unlock methods are used to prevent simultaneous access to the
<CODE>$Application</CODE> object.


<P>

<DL>
<DT><STRONG><A NAME="item__Application_Lock_">$Application->Lock()

</A></STRONG><DD>
Locks the Application object for the life of the script, or until
<CODE>UnLock()</CODE> unlocks it, whichever comes first. When
<CODE>$Application</CODE> is locked, this gaurantees that data being read
and written to it will not suddenly change on you between the reads and the
writes.


<P>

This and the <CODE>$Session</CODE> object both lock automatically upon
every read and every write to ensure data integrity. This lock is useful
for concurrent access control purposes.


<P>

Be careful to not be too liberal with this, as you can quickly create
application bottlenecks with its improper use.


<P>

<DT><STRONG><A NAME="item__Application_UnLock_">$Application->UnLock()

</A></STRONG><DD>
Unlocks the <CODE>$Application</CODE> object. If already unlocked, does
nothing.


<P>

</DL>
<P>
<HR>
<H2><A NAME="_Server_Object">$Server Object

</A></H2>
The server object is that object that handles everything that the other
objects don't. The best part of the server object for Win32 users is the
CreateObject method which allows developers to create instances of ActiveX
components, like the ADO component.


<P>

<DL>
<DT><STRONG><A NAME="item__Server_ScriptTimeout_">$Server->{ScriptTimeout} = $seconds

</A></STRONG><DD>
Will not be implemented, please see the Apache Timeout configuration
option, normally in httpd.conf.  


<P>

<DT><STRONG><A NAME="item__Server_CreateObject_program_i">$Server->CreateObject($program_id)

</A></STRONG><DD>
Allows use of ActiveX objects on Win32. This routine returns a reference to
an Win32::OLE object upon success, and nothing upon failure. It is through
this mechanism that a developer can utilize ADO. The equivalent syntax in
VBScript is 


<P>

<PRE> Set object = Server.CreateObject(program_id)
</PRE>

<P>

For further information, try 'perldoc Win32::OLE' from your favorite
command line.


<P>

<DT><STRONG><A NAME="item__Server_HTMLEncode_string_">$Server->HTMLEncode($string)

</A></STRONG><DD>
Returns an HTML escapes version of $string. &amp;, ``, &gt;, &lt;, are each
escapes with their HTML equivalents. Strings encoded in this nature should
be raw text displayed to an end user, as HTML tags become escaped with this
method.


<P>

<DT><STRONG><A NAME="item__Server_MapPath_virtual_direct">$Server->MapPath($virtual_directory);

</A></STRONG><DD>
Not implemented


<P>

<DT><STRONG><A NAME="item__Server_URLEncode_string_">$Server->URLEncode($string)

</A></STRONG><DD>
Returns the URL-escaped version of the string $string. +'s are substituted
in for spaces and special characters are escaped to the ascii equivalents.
Strings encoded in this manner are safe to put in url's... they are
especially useful for encoding data used in a query string as in:


<P>

<PRE> $data = $Server-&gt;URLEncode(&quot;test data&quot;);
 $url = &quot;<A HREF="http://localhost?data=">http://localhost?data=</A>$data&quot;;
</PRE>

<P>

<PRE> $url evaluates to <A HREF="http://localhost?data=test+data">http://localhost?data=test+data</A>, and is a 
 valid URL for use in anchor &lt;a&gt; tags and redirects, etc.
</PRE>

<P>

</DL>
<P>
<HR>
<H1><A NAME="EXAMPLES">EXAMPLES

</A></H1>
Use with Apache. Copy the ./eg directory from the ASP installation to your
Apache document tree and try it out! You have to put


<P>

<PRE> AllowOverride All
</PRE>

<P>

in your &lt;Directory&gt; config section to let the .htaccess file in the
/eg installation directory do its work.  


<P>

IMPORTANT (FAQ): Make sure that the web server has write access to that
directory. Usually a 


<P>

<PRE> chmod -R 0777 eg
</PRE>

<P>

will do the trick :)


<P>

<P>
<HR>
<H1><A NAME="FAQ">FAQ

</A></H1>
<DL>
<DT><STRONG><A NAME="item_How">How do I get things I want done?!

</A></STRONG><DD>
If you find a problem with the module, or would like a feature added,
please mail support, as listed below, and your needs will be promptly and
seriously considered, then implemented.


<P>

<DT><STRONG><A NAME="item_What">What is the state of Apache::ASP?  Can I publish a web site on it?

</A></STRONG><DD>
Apache::ASP has been production ready since v.02. Work being done on the
module is on a per-need basis, with the goal being to eventually have the
ASP API completed, with full portability to ActiveState's PerlScript and
MKS's PScript. If you can suggest any changes to facilitate these goals,
your comments are welcome.


<P>

<DT><STRONG><A NAME="item_I">I am getting a tie or MLDBM / state error message, what do I do?

</A></STRONG><DD>
Make sure the web server or you have write access to the eg directory, or
to the directory specified as Global in the config you are using. Default
for Global is the directory the script is in (e.g. '.'), but should be set
to some directory not under the www server's document root, for security
reasons, on a production site.


<P>

Usually a 


<P>

<PRE> chmod -R -0777 eg
</PRE>

<P>

will take care of the write access issue for initial testing purposes.


<P>

Failing write access being the problem, try upgrading your version of
Data::Dumper and MLDBM, which are the modules used to write the state
files.


<P>

<DT><STRONG>How do I access the ASP Objects in general?

</A></STRONG><DD>
All the ASP objects can be referenced through the main package with the
following notation:


<P>

<PRE> $main::Response-&gt;Write(&quot;html output&quot;);
</PRE>

<P>

This notation can be used from anywhere in perl. Only in your main ASP
script, can you use the normal notation:


<P>

<PRE> $Response-&gt;Write(&quot;html output&quot;);
</PRE>

<P>

<DT><STRONG><A NAME="item_Can">Can I print() in ASP?

</A></STRONG><DD>
Yes. You can <CODE>print()</CODE> from anywhere in an ASP script as it
aliases to the $Response-&gt;Write() method. However, this method is not
portable (unless you can tell me otherwise :)


<P>

</DL>
<P>
<HR>
<H1><A NAME="SEE_ALSO">SEE ALSO

</A></H1>
<CODE>perl(1),</CODE> <CODE>mod_perl(3),</CODE> <CODE>Apache(3),</CODE>
<CODE>MLDBM(3),</CODE> HTTP::Date(3), <CODE>CGI(3),</CODE> Win32::OLE(3)


<P>

<P>
<HR>
<H1><A NAME="NOTES">NOTES

</A></H1>
Many thanks to those who helped me make this module a reality. Whoever said
you couldn't do ASP on UNIX? Kudos go out to:


<P>

<PRE> :) Doug MacEachern, for moral support and of course mod_perl
 :) Ryan Whelan, for boldly testing on Unix in its ASP's early infancy
 :) Lupe Christoph, for his immaculate and stubborn testing skills
 :) Bryan Murphy, for being a PerlScript wiz.
 :) Francesco Pasqualini, for bringing ASP to CGI.
 :) Michael Rothwell, for his love of Session hacking.
</PRE>

<P>

<P>
<HR>
<H1><A NAME="SUPPORT">SUPPORT

</A></H1>
Please send any questions or comments to the Apache modperl mailing list at
<A HREF="MAILTO:modperl@apache.org">modperl@apache.org</A> or to me at <A
HREF="MAILTO:chamas@alumni.stanford.org.">chamas@alumni.stanford.org.</A>


<P>

<P>
<HR>
<H1><A NAME="COPYRIGHT">COPYRIGHT

</A></H1>
Copyright (c) 1998 Joshua Chamas. All rights reserved. This program is free
software; you can redistribute it and/or modify it under the same terms as
Perl itself. 


<P>

</DL>
    </BODY>

    </HTML>
